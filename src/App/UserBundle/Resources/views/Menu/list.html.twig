{% extends 'UserBundle::layout_menu.html.twig' %}


{% block title %}Eat&Fit{% endblock%}


{% block head2 %}
<a href="{{ path('App_user_showServicio') }}">Menús</a>
{% endblock %}

{% block body3 %}


<div class="grid-categories animated wow fadeInLeft" data-wow-duration="1000ms" data-wow-delay="500ms">
					<h4>Categoría</h4>
					<div class="buscador">
							{{form_start(form)}}
								<div class="form-group">
									{{ form_row(form.nombre) }}
									{{ form_row(form.publico) }}
								</div>
							{{form_end(form)}}
					</div>
          </br>
          <h4>Lista</h4>
          <div class="buscador">
              {{form_start(formLista)}}
                <div class="form-group">
                  {{ form_row(formLista.lista) }}
                </div>
              {{form_end(formLista)}}
          </div>
				</div>
{% endblock %}


{% block body2 %}



<div class="col-md-9 blog-header">
<div class="col-sm-12">
                            <button type="button" class="btn btn-success" data-toggle="modal" data-target="#myModal"><i class="glyphicon glyphicon-plus"></i>&nbsp;  Añadir nuevo menú</button>
                            <hr>
</div>
	</br>
	{% set numMenu=0%}
	<div class=" blog-head">
	{% for menu in pagination %}
        {% set numMenu=numMenu+1%}                                     
			<div class="col-md-4 blog-top">
				<div class="blog-in">
					<div class="blog-grid">
						<h3><a href="{{ path('App_user_showMenu', { 'id': menu.id }) }}">{{menu.nombre}}</a></h3>
						<div class="date">
							<span class="date-in"><i class="glyphicon glyphicon-calendar"> </i>{{ menu.fechaCreacion|date('Y-m-d') }}</span>
							<div class="clearfix"> </div>
						</div>
						<p>{{menu.descripcion(40)}}</p>
            <a class="btn btn-success" data-href={{menu.id}} data-toggle="modal" data-target="#confirm-comision"><i class="glyphicon glyphicon-plus"> </i></a>
						<div class="more">						
							<a class="link link-yaku" href="{{ path('App_user_showMenu', { 'id': menu.id }) }}">
								<span>L</span><span>e</span><span>e</span><span>r</span> <span>m</span><span>á</span><span>s</span>	
							</a>
						</div>
					</div>					
				</div>
			</div>	
	{% if (numMenu % 3 == 0)%}
		</div>
		<div class="clearfix"> </div>
		<div class=" blog-head">
	{% endif %}
		{% endfor %}
		</br>
		<div class="navigation">
			{{ knp_pagination_render(pagination) }}
		</div>
	</div>
</div>

<!-- Modal  ADDING -->
        <div id="myModal" class="modal fade" role="dialog">
          <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Añadir Menú</h4>
              </div>
              <div class="modal-body">
                  <div id="form_body">
                      {% include "UserBundle:Menu:add.html.twig"  with {'formMenu': formMenu} %}
                  </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="from-submit btn btn-default" data-dismiss="modal">Cancelar</button>
              </div>
            </div>
          </div>
        </div>


        <!-- Modal  ADDING Confirm -->
        <div id="addConfirm" class="modal fade" role="dialog">
          <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title"></h4>
              </div>
              <div class="modal-body">

              </div>
              <div class="modal-footer">
                <button  type="button" class="from-submit btn btn-default" data-dismiss="modal">Aceptar</button>
              </div>
            </div>

          </div>
        </div>

        <!-- Modal  OrdenCompra-->
        <div class="modal fade" id="confirm-comision" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">

                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="myModalLabel">Mensaje de confirmación</h4>
                    </div>

                    <div class="modal-body">
                                             {% include "UserBundle:OrdenCompra:add.html.twig"  with {'formOrdenCompra': formOrdenCompra} %}

                        <p class="debug-url"></p>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                        <a id="menuAdd"class="btn btn-success btn-ok">Guardar</a>
                    </div>
                </div>
            </div>
        </div>

{% endblock %}

{% block javascripts %}
<script>
        $('body').on('submit', '.ajaxForm', function (e) {

        e.preventDefault();

        $.ajax({
            type: $(this).attr('method'),
            url: $(this).attr('action'),
            data: $(this).serialize(),
            success: function(jqXHR) {
                        $('#myModal').modal('hide');

                        $('#addConfirm').find('.modal-body').html(jqXHR.message);
                        $('#addConfirm').find('.modal-title').html('Añadir')
                        $('#addConfirm').modal('show');
                        $("#addConfirm").modal();

                    },
                    error: function(jqXHR) {
                        if (jqXHR.responseJSON.hasOwnProperty('form')) {
                            $('#form_body').html(jqXHR.responseJSON.form);
                        }

                        $('.form_error').html(jqXHR.responseJSON.message);
                    },
            });
        });
    </script>

<script type="text/javascript" src="{{ asset('js/addMenuOrdenCompra.js') }}"></script>
   {% endblock %}