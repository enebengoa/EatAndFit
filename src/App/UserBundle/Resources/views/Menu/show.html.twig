{% extends 'UserBundle::layout_menu.html.twig' %}

{% block title %}Eat&Fit{% endblock%}
			{% set calorias = 0 %}
            {% for submenu in menu.subMenus %} 
                {% set calorias = calorias + (submenu.receta.calorias/submenu.receta.numeroComensales) %}                           
            {% endfor %}
{% block head2 %}<a href="{{ path('App_user_listMenu') }}">Menú "{{menu.nombre}}" ({{calorias}} cl/persona)</a>{% endblock %}

{% block body2 %}

<div class="col-md-12 blog-header">
<a class="btn btn-lg btn-success" href="{{path('App_user_listReceta') }}">Añadir nueva receta</a>
</br>
</br>
{% if (desayuno is empty)%}
{% else %}
<div class="col-md-9 blog-header">
	<h2>Desayuno</h2>
	{% set numReceta=0%}
	<div class=" blog-head">
	{% for receta in desayuno %}
        {% set numReceta=numReceta+1%} 
        <div id="{{receta.id}}-1">                                    
			<div class="col-md-4 blog-top">
				<div class="blog-in">
					<img class="img-responsive" src="{{ asset ('imagenes/'~receta.imagen)}}" alt=" ">
					<div class="blog-grid">
						<h3><a href="{{ path('App_user_showReceta', { 'id': receta.id }) }}">{{receta.nombre}}</a></h3>
						<div class="date">
							<span class="date-in"><i class="glyphicon glyphicon-calendar"> </i>{{ receta.fechaCreacion|date('Y-m-d') }}</span>
							<a href="single.html" class="comments"><i class="glyphicon glyphicon-comment"></i>{{receta.comentarios|length}}</a>
							<div class="clearfix"> </div>
						</div>
						<p><srong>Calorías: </strong> {{receta.calorias/receta.numeroComensales}} cl/persona </p>
						<button class="btn btn-danger" data-href="{{ path('App_user_deleteSubMenu', { 'receta': receta.id , 'menu': menu.id, 'horaIngesta' : 1}) }}" data-toggle="modal" data-target="#confirm-delete"><i class="glyphicon glyphicon-trash"> </i></button>
						<div class="more">						
							<a class="link link-yaku" href="{{ path('App_user_showReceta', { 'id': receta.id }) }}">
								<span>L</span><span>e</span><span>e</span><span>r</span> <span>m</span><span>á</span><span>s</span>	
							</a>
						</div>
					</div>					
				</div>
			</div>
		</div>	
	{% if (numReceta % 3 == 0)%}
		</div>
		<div class="clearfix"> </div>
		<div class=" blog-head">
	{% endif %}
		{% endfor %}
		</br>
	</div>
</div>
{% endif %}

{% if (almuerzo is empty)%}

{% else %}


<div class="col-md-9 blog-header">
	</br>
	<h2>Almuerzo</h2>
	{% set numReceta=0%}
	<div class=" blog-head">
	{% for receta in almuerzo %}
        {% set numReceta=numReceta+1%}
        <div id="{{receta.id}}-2">                                      
			<div class="col-md-4 blog-top">
				<div class="blog-in">
					<img class="img-responsive" src="{{ asset ('imagenes/'~receta.imagen)}}" alt=" ">
					<div class="blog-grid">
						<h3><a href="{{ path('App_user_showReceta', { 'id': receta.id }) }}">{{receta.nombre}}</a></h3>
						<div class="date">
							<span class="date-in"><i class="glyphicon glyphicon-calendar"> </i>{{ receta.fechaCreacion|date('Y-m-d') }}</span>
							<a href="single.html" class="comments"><i class="glyphicon glyphicon-comment"></i>{{receta.comentarios|length}}</a>
							<div class="clearfix"> </div>
						</div>
						<p><srong>Calorías: </strong> {{receta.calorias/receta.numeroComensales}} cl/persona</p>
						<button class="btn btn-danger" data-href="{{ path('App_user_deleteSubMenu', { 'receta': receta.id , 'menu': menu.id, 'horaIngesta' : 2}) }}" data-toggle="modal" data-target="#confirm-delete"><i class="glyphicon glyphicon-trash"> </i></button>
						<div class="more">						
							<a class="link link-yaku" href="{{ path('App_user_showReceta', { 'id': receta.id }) }}">
								<span>L</span><span>e</span><span>e</span><span>r</span> <span>m</span><span>á</span><span>s</span>	
							</a>
						</div>
					</div>					
				</div>
			</div>	
		</div>	
	{% if (numReceta % 3 == 0)%}
		</div>
		<div class="clearfix"> </div>
		<div class=" blog-head">
	{% endif %}
		{% endfor %}
		</br>
	</div>
</div>

{% endif %}



{% if (comida is empty)%}

{% else %}
<div class="col-md-9 blog-header">
	</br>
	<h2>Comida</h2>
	{% set numReceta=0%}
	<div class=" blog-head">
	{% for receta in comida %}
        {% set numReceta=numReceta+1%} 
        <div id="{{receta.id}}-3">                                     
			<div class="col-md-4 blog-top">
				<div class="blog-in">
					<img class="img-responsive" src="{{ asset ('imagenes/'~receta.imagen)}}" alt=" ">
					<div class="blog-grid">
						<h3><a href="{{ path('App_user_showReceta', { 'id': receta.id }) }}">{{receta.nombre}}</a></h3>
						<div class="date">
							<span class="date-in"><i class="glyphicon glyphicon-calendar"> </i>{{ receta.fechaCreacion|date('Y-m-d') }}</span>
							<a href="single.html" class="comments"><i class="glyphicon glyphicon-comment"></i>{{receta.comentarios|length}}</a>
							<div class="clearfix"> </div>
						</div>
						<p><srong>Calorías: </strong> {{receta.calorias/receta.numeroComensales}} cl/persona</p>
						<button class="btn btn-danger" data-href="{{ path('App_user_deleteSubMenu', { 'receta': receta.id , 'menu': menu.id, 'horaIngesta' : 3}) }}" data-toggle="modal" data-target="#confirm-delete"><i class="glyphicon glyphicon-trash"> </i></button>
						<div class="more">						
							<a class="link link-yaku" href="{{ path('App_user_showReceta', { 'id': receta.id }) }}">
								<span>L</span><span>e</span><span>e</span><span>r</span> <span>m</span><span>á</span><span>s</span>	
							</a>
						</div>
					</div>					
				</div>
			</div>	
		</div>	
	{% if (numReceta % 3 == 0)%}
		</div>
		<div class="clearfix"> </div>
		<div class=" blog-head">
	{% endif %}
		{% endfor %}
		</br>
	</div>
</div>
{% endif %}

{% if (merienda is empty)%}

{% else %}
<div class="col-md-9 blog-header">
	</br>
	<h2>Merienda</h2>
	{% set numReceta=0%}
	<div class=" blog-head">
	{% for receta in merienda %}
        {% set numReceta=numReceta+1%} 
        <div id="{{receta.id}}-4">                                     
			<div class="col-md-4 blog-top">
				<div class="blog-in">
					<img class="img-responsive" src="{{ asset ('imagenes/'~receta.imagen)}}" alt=" ">
					<div class="blog-grid">
						<h3><a href="{{ path('App_user_showReceta', { 'id': receta.id }) }}">{{receta.nombre}}</a></h3>
						<div class="date">
							<span class="date-in"><i class="glyphicon glyphicon-calendar"> </i>{{ receta.fechaCreacion|date('Y-m-d') }}</span>
							<a href="single.html" class="comments"><i class="glyphicon glyphicon-comment"></i>{{receta.comentarios|length}}</a>
							<div class="clearfix"> </div>
						</div>
						<p><srong>Calorías: </strong> {{receta.calorias/receta.numeroComensales}} cl/persona</p>
						<button class="btn btn-danger" data-href="{{ path('App_user_deleteSubMenu', { 'receta': receta.id , 'menu': menu.id, 'horaIngesta' : 4}) }}" data-toggle="modal" data-target="#confirm-delete"><i class="glyphicon glyphicon-trash"> </i></button>
						<div class="more">						
							<a class="link link-yaku" href="{{ path('App_user_showReceta', { 'id': receta.id }) }}">
								<span>L</span><span>e</span><span>e</span><span>r</span> <span>m</span><span>á</span><span>s</span>	
							</a>
						</div>
					</div>					
				</div>
			</div>	
		</div>	
	{% if (numReceta % 3 == 0)%}
		</div>
		<div class="clearfix"> </div>
		<div class=" blog-head">
	{% endif %}
		{% endfor %}
		</br>
	</div>
</div>
{% endif %}

{% if (cena is empty)%}

{% else %}
<div class="col-md-9 blog-header">
	</br>
	<h2>Cena</h2>
	{% set numReceta=0%}
	<div class=" blog-head">
	{% for receta in cena %}
        {% set numReceta=numReceta+1%} 
        <div id="{{receta.id}}-6">                                     
			<div class="col-md-4 blog-top">
				<div class="blog-in">
					<img class="img-responsive" src="{{ asset ('imagenes/'~receta.imagen)}}" alt=" ">
					<div class="blog-grid">
						<h3><a href="{{ path('App_user_showReceta', { 'id': receta.id }) }}">{{receta.nombre}}</a></h3>
						<div class="date">
							<span class="date-in"><i class="glyphicon glyphicon-calendar"> </i>{{ receta.fechaCreacion|date('Y-m-d') }}</span>
							<a href="single.html" class="comments"><i class="glyphicon glyphicon-comment"></i>{{receta.comentarios|length}}</a>
							<div class="clearfix"> </div>
						</div>
						<p><srong>Calorías: </strong> {{receta.calorias/receta.numeroComensales}} cl/persona</p>
						<button class="btn btn-danger" data-href="{{ path('App_user_deleteSubMenu', { 'receta': receta.id , 'menu': menu.id, 'horaIngesta' : 6}) }}" data-toggle="modal" data-target="#confirm-delete"><i class="glyphicon glyphicon-trash"> </i></button>
						<div class="more">						
							<a class="link link-yaku" href="{{ path('App_user_showReceta', { 'id': receta.id }) }}">
								<span>L</span><span>e</span><span>e</span><span>r</span> <span>m</span><span>á</span><span>s</span>	
							</a>
						</div>
					</div>					
				</div>
			</div>	
		</div>	
	{% if (numReceta % 3 == 0)%}
		</div>
		<div class="clearfix"> </div>
		<div class=" blog-head">
	{% endif %}
		{% endfor %}
		</br>
	</div>
</div>
{% endif %}
</div>


<div class="modal fade" id="confirm-delete" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">Mensaje de confirmación</h4>
                </div>

                <div class="modal-body">
                    <p>¿Desea borrar la receta de este menú?</p>
                    <p class="debug-url"></p>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                    <a class="btn btn-danger btn-ok">Borrar</a>
                </div>
            </div>
        </div>

{% endblock %}
{% block javascripts %}
<script>
        $('#confirm-delete').on('show.bs.modal', function(e) {
            $(".btn-ok").click(function () {

                $.ajax({
                    type: 'POST',
                    dataType: 'json',
                    url: $(e.relatedTarget).data('href'),
                    success: function(jqXHR) {
                    	console.log(jqXHR.id);
                        $(jqXHR.id).remove();
                        $('#confirm-delete').modal('hide');
                        

                        $('#addConfirm').find('.modal-body').html(jqXHR.message);
                        $('#addConfirm').find('.modal-title').html('Borrar')
                        $('#addConfirm').modal('show');
                        $("#addConfirm").modal();



                    },
                    error: function(jqXHR) {
                        $('#confirm-delete').modal('hide');

                        $('#addConfirm').find('.modal-body').html(jqXHR.responseJSON.message);
                        $('#addConfirm').find('.modal-title').html('NO Borrado')
                        $('#addConfirm').modal('show');
                        $("#addConfirm").modal();

                    },
                });
            });
        });
  </script>
  
 {% endblock %}

